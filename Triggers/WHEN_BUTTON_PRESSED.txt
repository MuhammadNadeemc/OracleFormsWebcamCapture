DECLARE
   v_filename VARCHAR2(256);
   v_file_text VARCHAR2(1000);
   file_handle UTL_FILE.FILE_TYPE;
BEGIN
   -- Execute the Java program using global variables for Java paths and library paths
   HOST(:global.java_exec || ' -Djava.library.path="' || :global.java_lib_path || '" -cp "' || :global.java_lib_path || '\opencv-411.jar;' || :global.java_lib_path || '" WebcamCapture');

   -- Optional: Display a message to confirm the command has been executed
   -- MESSAGE('Java program executed.');

   -- Check if the file path can be opened
   BEGIN
      -- Open the file containing the image path using the directory object
      file_handle := UTL_FILE.FOPEN('TEMP_DIR', :global.image_file, 'r');
      UTL_FILE.GET_LINE(file_handle, v_file_text);  -- Read the image path
      UTL_FILE.FCLOSE(file_handle);
   EXCEPTION
      WHEN OTHERS THEN
         MESSAGE('Error reading file path: ' || SQLERRM);
         RETURN;
   END;
   
   -- Now load the image into the image item in Oracle Forms using dynamic block/item name
   IF v_file_text IS NOT NULL THEN
      -- Use the image path to load the image into the dynamically named block and item
      READ_IMAGE_FILE(v_file_text, 'JPEG', :global.block_name || '.' || :global.image_item);
      
      -- Log successful loading
      MESSAGE('Image loaded successfully.');
   ELSE
      MESSAGE('No image selected.');
   END IF;
END;
